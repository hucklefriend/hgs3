# sudo apt-get install openssh-server


○以下、VMware環境のみ

$ sudo apt-get install git
$ cd /usr/local/src
$ sudo git clone https://github.com/rasa/vmware-tools-patches.git
$ cd vmware-tools-patches
$ sudo ./patched-open-vm-tools.sh -d

VM wareのフォルダ共有設定をする

$ sudo ln -s /mnt/hgfs/hgs3 /var/hgs3


○ Apache

$ sudo apt-get install apache2


○ MariaDB

sudo apt-get install software-properties-common
sudo apt-key adv --recv-keys --keyserver hkp://keyserver.ubuntu.com:80 0xF1656F24C74CD1D8
sudo add-apt-repository 'deb [arch=amd64,i386] http://ftp.yz.yamagata-u.ac.jp/pub/dbms/mariadb/repo/10.2/ubuntu zesty main'
sudo apt update
sudo apt install mariadb-server

# mysql -u root


アプリ用ユーザー追加
-- 開発用
CREATE USER 'hgs'@'localhost' IDENTIFIED BY '';
CREATE DATABASE hgs3 CHARACTER SET utf8mb4;
CREATE DATABASE hgs2;
GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, INDEX, ALTER, CREATE TEMPORARY TABLES, CREATE VIEW, EVENT, TRIGGER, SHOW VIEW, CREATE ROUTINE, ALTER ROUTINE, EXECUTE ON `hgs3`.* TO 'hgs'@'localhost';
GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, INDEX, ALTER, CREATE TEMPORARY TABLES, CREATE VIEW, EVENT, TRIGGER, SHOW VIEW, CREATE ROUTINE, ALTER ROUTINE, EXECUTE ON `hgs2`.* TO 'hgs'@'localhost';

-- 本番用
CREATE USER 'hgs'@'localhost' IDENTIFIED BY 'パスワード';
CREATE DATABASE hgs3 CHARACTER SET utf8mb4;
GRANT SELECT, INSERT, UPDATE, DELETE, EXECUTE ON `hgs3`.* TO 'hgs'@'localhost';

exit;

○ PHP
sudo apt-get install php php-cli php-common libapache2-mod-php php-mysql php-curl php-xml php-zip php-gd php-mbstring  php-bcmath php-mcrypt php-json


○ Memcached
sudo apt-get install memcached
sudo apt-get install php-memcached





○ Apacheコンフィグ

# sudo vi /etc/apache2/sites-available/hgn.conf
alias /hgn /var/hgs3/web/public
<Directory /var/hgs3/web/public>
    Options FollowSymLinks Indexes
    AllowOverride All
    Require all granted
</Directory>

# sudo a2ensite hgn.conf
# sudo a2enmod rewrite



○ Laravel設定

cd (laravel設置パス)
chmod 777 -R storage
chmod 777 -R bootstrap/cache


php artisan key:generate
php artisan config:clear


○ phpMyAdmin(開発環境のみ)

# sudo apt install phpmyadmin
# sudo vi /etc/phpmyadmin/config.inc.php

$cfg['Servers'][$i]['AllowNoPassword'] = true;


○ アプリ設置
cd アプリのパス
# rm composer.lock
# php composer.phar install
# php artisan migrate
# php artisan versionup:database


○ MongoDB

https://docs.mongodb.com/manual/tutorial/install-mongodb-on-ubuntu/

sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 0C49F3730359A14518585931BC711F9BA15703C6
echo "deb [ arch=amd64,arm64 ] http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.4 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-3.4.list
sudo apt-get update
sudo apt-get install mongodb-org
sudo apt-get install php-dev
sudo apt-get install pkg-config libssl-dev libsslcommon2-dev
sudo pecl install mongodb
sudo phpenmod mongodb

sudo service mongod start
sudo service apache2 restart


sudo systemctl enable mongod.service



mongo hgs3
use hgs3
db.createCollection('timeline');
db.createCollection('personal_timeline');
db.createCollection('site_footprint');
